{% extends 'base.html' %}
{% block title %}
Search by District
{% endblock title %}

{% block content %}
<form action="{% url 'searchByDistrictResults' %}" method="post">
    {% csrf_token %}
    <label for="state">Choose a state:</label>
    <select name="state" id="state">
    <option value="">---------</option>
    {% for state in states %}
        <option value={{ state.state_id }}>{{ state.state_name }}</option>
    {% endfor %}
    </select><br>
    <label for="district_id">Choose a district:</label>
    <select name="district_id" id="district_id">
    <option >---------</option>
    </select><br>
    <input id="date" name="date" type="date" placeholder="dd-mm-yyyy"><br>
    {% comment %} <input type="checkbox" id="getCalender" name="getCalender" value="Boat">
    <label for="getCalender"> Get 7 days results from the given date</label><br> {% endcomment %}
    <div class="form-check">
        <input type="hidden" name="getFor7Days" value="no">
        <input class="form-check-input" type="checkbox" value="yes" id="getFor7Days" name="getFor7Days" checked>
        <label class="form-check-label" for="getfor7Days">
            Get 7 days details Calender
        </label>
    </div>
    <input type="submit" value="Submit">
</form>
{% comment %} {% for state in states %}
{{ state.state_name }}
{% endfor %} {% endcomment %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
    // get the list of districts dynamically when changing the state value
    $("#state").change(function () {
        var state_id = $("#state").val();
        if(state_id==""){
            $("#district_id").html("<option >---------</option>")
        }
        // GET AJAX request to fetch districts list based on the state input
        $.ajax({
            type: 'GET',
            url: "{% url 'load_districts' %}",
            data: {"state_id": state_id},
            success: function (data) {
                $("#district_id").html(data);
            },
            error: function (data) {
                console.log(data)
            }
        })
    })
</script>
{% endblock content %}
